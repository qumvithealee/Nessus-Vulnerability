# Nessus-Vulnerability Scan Tutorial

## Introduction

In this project, I installed and configured Nessus Essentials to perform credentialed vulnerability scans against Windows 10 Hosts. We want to capture the steps of vulnerability management function on my sandbox network: Discover, Prioritize, Assess, Report, Remediate, and Verify. Read on for the step by step guide on how you can conduct a vulnerability scan. 

## TLDR 

1. Download and install VMware player 17 (https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html)
2. Download Windows 10 ISO (https://www.microsoft.com/en-us/software-download/windows10)
3. Download and install Nessus Essentials (https://www.tenable.com/products/nessus/nessus-essentials)
4. Run VMware player and use Windows 10 ISO to create virtual machine
5. Identify the IP address of your Windows 10 VM
6. Run non-credentialed scan on Nessus of your Windows 10 VM
7. Run credentialed scan of your VM
8. Identify the vulnerabilties and follow remediation suggestions

## Installation

In order to conduct this scan we will need to set up environment with the following: VMware for our VM, Windows 10 ISO, and Nessus Essentials. I chose Windows 10 for it's out the box vulnerabilities, feel free to use older versions of windows and watch Nessus go to work. Download and install all the software, feel free to take a break whil things are cooking. 

When you run VMware, install the Windows 10 ISO you downloaded, make sure you have enough room on your rig. During the windows installation, choose Windows 10 Pro, use offline mode, and make a dummy account with an easy to remember password. The Nessus installation will produce a https://localhost address, I highly recommend you copy and paste this on a notepad document for later and to navigate to Nessus. 

## Windows 10 VM

Before we can scan our host, we need the IPv4 address and disable the firewall. In order to do this, search wf.msc and disable all windows firewall otions. Next, search for command prompt, type in ipconfig and it will populate the IPv4 address.

## Nessus Non-Credentialed Scan

We're going to conduct a non-credentialed scan first then a credentialed one to compare the results. Navigate to Nessus, click on my scans, name it Windows 10 Single Host, input the VM's IPv4 address, hit save.
Launch the non-credentialed scan and lets check back in a couple of minutes for our results.

![non-credentialed scan results](https://i.imgur.com/aBDnKb.jpg)

![non-credentialed scan results](https://i.imgur.com/aBDnKb.jpg)


As you can see, we could not capture the full picture of our VM because we lacked the credentials to do a full scan.

## Setting up VM for a Credentialed Scan

Let's go back to our VM and search services.msc. Scroll down and find Remote Registry, change startup type to automatic, hit Start. 

![remote registry](https://i.imgur.com/aBDnKb.jpg)

Search file and printer sharing and we want to enable if they're not already. 

![network discovery and sharing](https://i.imgur.com/aBDnKb.jpg)

Search user account control, lets disable it. 

Search reg edit and go down this path:
-local machine
-software
-Microsoft
-Windows
-Current version
-Policies
-System

Right click anywhere and create a D-word, rename it to,"LocalAccountTokenFilterPolicy" Double click your new D-word and set filter to 1.

![d-word](https://i.imgur.com/aBDnKb.jpg)

Restart your VM

## Full sending a Credentialed Scan

Return back to Nessus and go back to your original scan, click more, and configure. Add the credentials of your Windows 10 VM, click save and launch!

![credentialed scan results](https://i.imgur.com/aBDnKb.jpg)

Click the remediations tab and lets check out the critical priorities. It look's like a Windows update will solve these issues. On our sandbox this is a simple and quick process but if you were part of a large organization, you would have to submit a change management request before any further actions can happen. 

## Installing an old deprecated version of Firefox and Remediation 

A Windows update is fine and all but lets practice remediation of a vulnerability. Go back to your VM and download and install firefox 3.6.12.exe. Run another scan and Firefox shows up as a critical vulnerability. 

![credentialed scan firefox results](https://i.imgur.com/aBDnKb.jpg)

In order to remediate this, let's uninstall Firefox and run a windows update on our VM, after those are done, run another scan. Voila, we zapped a number of vulnerabilties down! 

![credentialed scan results](https://i.imgur.com/aBDnKb.jpg)

